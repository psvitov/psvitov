# Домашнее задание к занятию 5. «Оркестрация кластером Docker контейнеров на примере Docker Swarm»


## Задача 1

Дайте письменые ответы на вопросы:

- В чём отличие режимов работы сервисов в Docker Swarm-кластере: replication и global?
- Какой алгоритм выбора лидера используется в Docker Swarm-кластере?
- Что такое Overlay Network?

## Ответ:

#### В чём отличие режимов работы сервисов в Docker Swarm кластере: replication и global?

При режиме работы сервисов replication в Docker Swarm кластере созданные реплики контейнера распределяются по всем нодам равномерно. Если количество нод меньше количества реплик, на ноде может быть запущено несколько реплик, если количество нод больше количества реплик, то на некоторых нода реплик не будет. При выходе ноды из строя реплики будут распределяться по оставшимся нодам.
При режиме работы сервисов global в Docker Swarm кластере, на каждую ноду ставится контейнер. Если нода выходит из строя контейнер отключается, если добавляется новая нода, контейнер добавляется на новую ноду.

#### Какой алгоритм выбора лидера используется в Docker Swarm кластере?

Среди всех созданных менеджеров в кластере  Docker Swarm всегда присутствует один, который на данный момент является лидером кластера. Все управляющие команды, которые выполняются на других менеджерах автоматически перенаправляются на него. При отключении менеджера с ролью лидера, роль лидера передается другому менеджеру. В кластере для соблюдения отказоустойчивости необходимо иметь как минимум 3 менеджера.

#### Что такое Overlay Network?

Overlay-сети используются в кластере Docker Swarm, где виртуальная сеть, которую используют контейнеры, связывает несколько физических хостов, на которых запущен Docker. Когда запускается контейнер на кластере, как часть сервиса, множество сетей присоединяется по умолчанию, и каждая из них соответствует разным требованиям связи.По сути к каждой реплике создается виртуальный сетевой интерфес.

## Задача 2

Создайте ваш первый Docker Swarm-кластер в Яндекс Облаке.

Чтобы получить зачёт, предоставьте скриншот из терминала (консоли) с выводом команды:
```
docker node ls
```
## Ответ:

Скриншот консоли с выводом команды:

![5_5-1.png](https://github.com/psvitov/devops-netology/blob/main/Homework/virt_homework_5_5/5_5-1.png)

## Задача 3

Создайте ваш первый, готовый к боевой эксплуатации кластер мониторинга, состоящий из стека микросервисов.
Чтобы получить зачёт, предоставьте скриншот из терминала (консоли), с выводом команды:

```
docker service ls
```

## Ответ:

Скриншоты:

---
![5_5-2.png](https://github.com/psvitov/devops-netology/blob/main/Homework/virt_homework_5_5/5_5-2.png)
---
![5_5-3.png](https://github.com/psvitov/devops-netology/blob/main/Homework/virt_homework_5_5/5_5-3.png)
---

## Задача 4

Выполните на лидере Docker Swarm-кластера команду, указанную ниже, и дайте письменное описание её функционала — что она делает и зачем нужна:
```
docker swarm update --autolock=true
```

## Ответ:

Данная команда выполняет шифрование и автоблокировку конфигурации кластера. При перезапуске Docker необходимо будет ввести ключ шифрования для раблокировки. Это необходимо для того чтобы защитить ключи TLS от утечки и взлома кластера.

![5_5-4.png](https://github.com/psvitov/devops-netology/blob/main/Homework/virt_homework_5_5/5_5-4.png)
